(this["webpackJsonpcarta-historia"]=this["webpackJsonpcarta-historia"]||[]).push([[0],{226:function(e,t,a){e.exports=a(537)},231:function(e,t,a){},232:function(e,t,a){},531:function(e,t,a){},532:function(e,t,a){},537:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(20),o=a.n(l),i=(a(231),a(33)),s=a(34),c=a(52),u=a(51),m=(a(232),a(64)),h=a.n(m),b=a(98),d=a(97),p=a.n(d),y=(a(529),a(530),a(531),function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,[{key:"loadDataset",value:function(){var e=Object(b.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(window.location.href,"/db.csv"));case 2:return t=e.sent,e.t0=this,e.next=6,t.text();case 6:return e.t1=e.sent,a=e.t0._createDatasetFromCsv.call(e.t0,e.t1),this._cleanYearInDataset(a),this._addGeoToDataset(a),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_createDatasetFromCsv",value:function(e){var t={headers:[],items:[]},a=e.split("\n");if(a.length<1)return t;a.pop();var n=a.shift().split(","),r=a.map((function(e){for(var t={},a=e.split(","),r=0;r<n.length;r++)t[n[r]]=a[r];return t}));return t.headers=n,t.items=r,t}},{key:"_cleanYearInDataset",value:function(e){var t=e.items.reduce((function(e,t){var a=parseInt(t.year);return isNaN(a)||(t.year=a,e.push(t)),e}),[]);e.items=t}},{key:"_addGeoToDataset",value:function(e){var t=/Point\((-?[0-9]+[.]?[0-9]*) (-?[0-9]+[.]?[0-9]*)\)/;e.headers=e.headers.concat(["lat","lng"]),e.items.forEach((function(e){var a=t.exec(e.locationCoordinates);a&&(e.lat=a[2],e.lng=a[1])}))}}]),e}()),v=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).SCATTER_GL_SIZE=3,n.TIMELINE_BACKGROUND_COLOR="rgba(47, 57, 77, 0.5)",n.TIMELINE_LINE_COLOR="rgba(146, 176, 155, 0.5)",n.TEXT_COLOR="#fff",n.echartsInstance=null,n.apiProxy=null,n.apiProxy=new y,n}return Object(s.a)(a,[{key:"_getBattleCountByYear",value:function(e){var t=e.reduce((function(e,t){var a=t.year;return a in e||(e[a]=0),e[a]++,e}),{}),a=Object.entries(t).map((function(e){return e[0]=parseInt(e),e}));return a.sort((function(e,t){return e[0]>t[0]?1:-1})),a}},{key:"_getScatterSeriesData",value:function(e){return e.items.map((function(e){return{name:e.battleLabel,value:[e.lng,e.lat,e]}}))}},{key:"_formatYear",value:function(e){var t=Math.round(e);return Math.abs(t)+(t>0?" CE":" BCE")}},{key:"componentDidMount",value:function(){var e=Object(b.a)(h.a.mark((function e(){var t,a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,this.echartsInstance=p.a.init(document.getElementById("echarts_container")),e.next=4,this.apiProxy.loadDataset();case 4:a=e.sent,window.onresize=function(){t.echartsInstance.resize()},this.echartsInstance.on("dataZoom",(function(){var e=t.echartsInstance.getOption().dataZoom[0];t.echartsInstance.setOption({visualMap:{id:"battles-geo-scattergl",min:Math.round(e.startValue,0),max:Math.round(e.endValue,0),textStyle:{color:t.TEXT_COLOR}}})})),n={backgroundColor:"#000",geo:{map:"world",roam:!0,label:{emphasis:{show:!1}},silent:!0,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#111"},emphasis:{areaColor:"#2a333d"}},zoom:2,bottom:"10%",zlevel:100},grid:[{id:"battles-time-line",top:"90%",show:!0,backgroundColor:t.TIMELINE_BACKGROUND_COLOR,zlevel:200}],dataset:{dimensions:a.headers,source:a.items},xAxis:{id:"battles-time-line-x",gridId:"battles-time-line",type:"value",name:"Year",nameTextStyle:{color:t.TEXT_COLOR},axisLabel:{textStyle:{color:t.TEXT_COLOR},formatter:t._formatYear},animation:!1,zlevel:201},yAxis:{id:"battles-time-line-y",gridId:"battles-time-line",type:"value",name:"# of Battles per Year",nameTextStyle:{color:t.TEXT_COLOR},axisLabel:{textStyle:{color:t.TEXT_COLOR},showMinLabel:!1},splitNumber:1,splitLine:{show:!1},silent:!0,animation:!1,zlevel:201},series:[{id:"battles-geo-scattergl",type:"scatterGL",progressive:1e6,coordinateSystem:"geo",symbolSize:t.SCATTER_GL_SIZE,blendMode:"lighter",zlevel:101},{id:"battles-geo-scatter",type:"scatter",coordinateSystem:"geo",data:t._getScatterSeriesData(a),symbolSize:15,itemStyle:{opacity:0},large:!0,animation:!1,tooltip:{formatter:function(e){var a=e.value[2];return a.battleLabel+"<br/>"+t._formatYear(a.year)}},zlevel:110},{id:"battles-time-line",type:"line",xAxisIndex:0,yAxisIndex:0,data:this._getBattleCountByYear(a.items),lineStyle:{color:t.TIMELINE_LINE_COLOR},itemStyle:{color:t.TEXT_COLOR,borderColor:t.TEXT_COLOR},symbolSize:1,tooltip:{show:!1},animation:!1,zlevel:201}],dataZoom:[{id:"battles-time-line",type:"slider",show:!0,xAxisIndex:[0],start:40,end:55,zlevel:201}],tooltip:{trigger:"item"},visualMap:[{id:"battles-geo-scattergl",seriesIndex:0,dimension:"year",type:"piecewise",splitNumber:10,min:-3e3,max:3e3,inRange:{color:["#94b9af","#90a583","#9d8420","#593837","#942911"]},outOfRange:{color:["rgba(0, 0, 0, 0.5)"]},textStyle:{color:t.TEXT_COLOR},bottom:"15%",formatter:function(e,a){return t._formatYear(e)+" to "+t._formatYear(a)},zlevel:110}]},this.echartsInstance.setOption(n,!0);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"BattleVisualizer"},r.a.createElement("div",{id:"echarts_container",className:"ChartArea"}))}}]),a}(r.a.Component),f=a(63),g=a(136),E=a(225),O=a(223),w=(a(532),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={showFullscreen:!0},n.toggleFullscreenOverlay=n.toggleFullscreenOverlay.bind(Object(f.a)(n)),n}return Object(s.a)(a,[{key:"toggleFullscreenOverlay",value:function(){this.setState({showFullscreen:!0})}},{key:"renderHouskeepingTooltip",value:function(e){return r.a.createElement(O.a,e,"Author: ",r.a.createElement("a",{href:"http://github.com/halfacat1/",target:"_blank",rel:"noopener noreferrer"},"Han Z."),r.a.createElement("br",null),r.a.createElement("br",null),"Built with:\xa0",r.a.createElement("a",{href:"https://www.echartsjs.com/",target:"_blank",rel:"noopener noreferrer"},"ECharts"),",\xa0",r.a.createElement("a",{href:"https://reactjs.org/",target:"_blank",rel:"noopener noreferrer"},"React"),r.a.createElement("br",null),"Powered by: ",r.a.createElement("a",{href:"https://www.wikidata.org/",target:"_blank",rel:"noopener noreferrer"},"Wikidata"))}},{key:"render",value:function(){return r.a.createElement("div",{className:"HelpOverlay"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-xs HelpOverlayContainer"},r.a.createElement(x,{show:this.state.showFullscreen}),r.a.createElement(g.a,{variant:"outline-light",onClick:this.toggleFullscreenOverlay},r.a.createElement("span",{role:"img",className:"Glow","aria-labelledby":"jsx-a11y/accessible-emoji"},"\ud83d\udca1"))),r.a.createElement("div",{className:"col-xs HelpOverlayContainer"},r.a.createElement(E.a,{placement:"bottom",overlay:this.renderHouskeepingTooltip,trigger:"click"},r.a.createElement(g.a,{variant:"outline-light"},r.a.createElement("span",{role:"img","aria-labelledby":"jsx-a11y/accessible-emoji"},"\ud83d\udc4b")))))))}}]),a}(r.a.Component)),x=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={show:e.show,style:{height:"100%",opacity:1}},n.openFullscreenOverlay=n.openFullscreenOverlay.bind(Object(f.a)(n)),n.closeFullscreenOverlay=n.closeFullscreenOverlay.bind(Object(f.a)(n)),n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){e.show&&!t.show&&this.openFullscreenOverlay()}},{key:"openFullscreenOverlay",value:function(){this.setState({show:!0,style:{height:"100%",opacity:1}})}},{key:"closeFullscreenOverlay",value:function(){this.setState({show:!1,style:{height:0,opacity:0}})}},{key:"render",value:function(){return r.a.createElement("div",{className:"overlay",style:this.state.style,onClick:this.closeFullscreenOverlay},r.a.createElement("div",{className:"title"},r.a.createElement("h2",null,"Carta Historia"),r.a.createElement("p",null,"Visualize battles throughout history across the world!"),r.a.createElement("h5",null,"Instructions"),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-labelledby":"jsx-a11y/accessible-emoji"},"\ud83d\uddfa + \ud83d\uddb1/\ud83d\udc46\ud83e\udd0f"),r.a.createElement("br",null),"Click/Scroll/Tap/Pinch to interact with the map"),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-labelledby":"jsx-a11y/accessible-emoji"},"\ud83d\uddfa\ud83d\udd34\ud83d\udfe0\ud83d\udfe2 + \ud83d\uddb1/\ud83d\udc46"),r.a.createElement("br",null),"Each dot on the map is a battle, colored by its date",r.a.createElement("br",null),"Hover/Click to see info "),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-labelledby":"jsx-a11y/accessible-emoji"},"\u2b07\ud83d\udcc8 + \u2194"),r.a.createElement("br",null),r.a.createElement("strong",null,"Timeline")," (bottom) ",r.a.createElement("br",null)," Drag to resize & move the timeline on the bottom, to change the range of battles to highlight"),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement("span",{className:"Glow",role:"img","aria-labelledby":"jsx-a11y/accessible-emoji"},"\ud83d\udca1")," to reopen this overlay"),r.a.createElement("h2",null,r.a.createElement("span",{role:"img","aria-labelledby":"jsx-a11y/accessible-emoji"},"\ud83d\uddb1/\ud83d\udc46"),"anywhere to begin!")))}}]),a}(r.a.Component),C=w,_=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(C,null),r.a.createElement(v,null))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(536);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[226,1,2]]]);
//# sourceMappingURL=main.55bc7d67.chunk.js.map